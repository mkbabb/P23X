Microsoft (R) Macro Assembler Version 6.11		    03/22/21 00:52:57
NEXTVAL.ASM						     Page 1 - 1


				;---------------------------------------------------------------------
				; Program:   nextval subroutine
				;
				; Function:  Find next mouse move in an array 15 by 30.
				;            We can move into a position if its contents is blank ( 20h ).
				;
				; Input:     Calling sequence is:
				;            x    pointer   si
				;            y    pointer   di
				;            dir  pointer   bx
				;            maze pointer   bp
				;
				; Output:    x,y,dir modified in caller's data segment
				;
				; Owner:     Dana A. Lasher
				;
				; Date:      Update Reason
				; --------------------------
				; 11/06/2016 Original version
				;---------------------------------------
				         .model    small               ;64k code and 64k data
				         .8086                         ;only allow 8086 instructions
				         public    nextval             ;allow extrnal programs to call
				;---------------------------------------
 0000				         .data  
 0000 1E			p0 db 30                    
 0000				         .code                       
 0000				nextval:
 0000  55			    push bp
 0001  50			    push ax
 0002  51			    push cx

 0003				calc_offset:
 0003  33 C0			    xor ax, ax

 0005  8A 05			    mov al, ds:[di] 
 0007  83 E8 01			    sub ax, 1
				    
 000A  B9 001E			    mov cx, 30
 000D  F6 E1			    mul cl

 000F  8A 0C			    mov cl, BYTE PTR ds:[si]

 0011  03 C1			    add ax, cx
				    
 0013  03 E8			    add bp, ax

 0015				nextval_main:
 0015  80 3F 02			    cmp BYTE PTR ds:[bx], 2
 0018  74 34			    je testw
 001A  72 23			    jb tests
 001C  80 3F 04			    cmp BYTE PTR ds:[bx], 4
 001F  74 0F			    je teste
 0021				testn:
 0021  3E: 80 7E E1 20		    cmp BYTE ptr ds:[bp - 1 - 30], ' '
 0026  75 26			    jne testw
 0028  83 2D 01			    sub WORD PTR ds:[di], 1
 002B  C6 07 04			    mov BYTE ptr ds:[bx], 4
 002E  EB 2B			    jmp next_val_exit
 0030				teste:
 0030  3E: 80 7E 00 20		    cmp BYTE ptr ds:[bp - 1 + 1], ' '
 0035  75 EA			    jne testn
 0037  83 04 01			    add WORD PTR ds:[si], 1
 003A  C6 07 01			    mov BYTE ptr ds:[bx], 1
 003D  EB 1C			    jmp next_val_exit
 003F				tests:
 003F  3E: 80 7E 1D 20		    cmp BYTE ptr ds:[bp - 1 + 30], ' '
 0044  75 EA			    jne teste
 0046  83 05 01			    add WORD PTR ds:[di], 1
 0049  C6 07 02			    mov BYTE ptr ds:[bx], 2
 004C  EB 0D			    jmp next_val_exit
 004E				testw:
 004E  3E: 80 7E FE 20		    cmp BYTE ptr ds:[bp - 1 - 1], ' '
 0053  75 EA			    jne tests
 0055  83 2C 01			    sub WORD PTR ds:[si], 1
 0058  C6 07 03			    mov BYTE ptr ds:[bx], 3
 005B				next_val_exit:
 005B  59			    pop cx
 005C  58			    pop ax
 005D  5D			    pop bp
 005E  C3			    ret

 005F				exit:
				    end   
Microsoft (R) Macro Assembler Version 6.11		    03/22/21 00:52:57
NEXTVAL.ASM						     Symbols 2 - 1




Segments and Groups:

                N a m e                 Size     Length   Align   Combine Class

DGROUP . . . . . . . . . . . . .	GROUP
_DATA  . . . . . . . . . . . . .	16 Bit	 0001	  Word	  Public  'DATA'	
_TEXT  . . . . . . . . . . . . .	16 Bit	 005F	  Word	  Public  'CODE'	


Symbols:

                N a m e                 Type     Value    Attr

@CodeSize  . . . . . . . . . . .	Number	 0000h	 
@DataSize  . . . . . . . . . . .	Number	 0000h	 
@Interface . . . . . . . . . . .	Number	 0000h	 
@Model . . . . . . . . . . . . .	Number	 0002h	 
@code  . . . . . . . . . . . . .	Text   	 _TEXT
@data  . . . . . . . . . . . . .	Text   	 DGROUP
@fardata?  . . . . . . . . . . .	Text   	 FAR_BSS
@fardata . . . . . . . . . . . .	Text   	 FAR_DATA
@stack . . . . . . . . . . . . .	Text   	 DGROUP
calc_offset  . . . . . . . . . .	L Near	 0003	  _TEXT	
exit . . . . . . . . . . . . . .	L Near	 005F	  _TEXT	
next_val_exit  . . . . . . . . .	L Near	 005B	  _TEXT	
nextval_main . . . . . . . . . .	L Near	 0015	  _TEXT	
nextval  . . . . . . . . . . . .	L Near	 0000	  _TEXT	Public
p0 . . . . . . . . . . . . . . .	Byte	 0000	  _DATA	
teste  . . . . . . . . . . . . .	L Near	 0030	  _TEXT	
testn  . . . . . . . . . . . . .	L Near	 0021	  _TEXT	
tests  . . . . . . . . . . . . .	L Near	 003F	  _TEXT	
testw  . . . . . . . . . . . . .	L Near	 004E	  _TEXT	

	   0 Warnings
	   0 Errors
